@using System.Activities.Expressions
@using ApartmentApps.Data
@model ApartmentApps.Portal.Controllers.DashboardBindingModel
<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-sm-4">
        <h2>Dashboard</h2>
        <ol class="breadcrumb">
            <li class="active">
                @*<strong>@Model.StartDate.Value.ToShortDateString() - @Model.EndDate.Value.ToShortDateString()</strong>*@
            </li>
        </ol>
    </div>
</div>
<br/>
<div class="row">
    <div class="col-md-6">
        <div class="row">
            <div class="col-lg-6">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        @*<span class="label label-success pull-right">Total Outstanding</span>*@
                        <h5>Maintenance</h5>
                    </div>
                    <div class="ibox-content">
                        <h1 class="no-margins">@Model.MaintenanceTotalOutstanding</h1>
                        <div class="stat-percent font-bold text-success">
                            @*98% <i class="fa fa-bolt"></i>*@
                        </div>
                        <small>Total Outstanding</small>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        @*<span class="label label-success pull-right">Total Outstanding</span>*@
                        <h5>Maintenenance</h5>
                    </div>
                    <div class="ibox-content">
                        <h1 class="no-margins">@Model.MaintenanceTotalOutstanding</h1>
                        <div class="stat-percent font-bold text-success">
                            @*98% <i class="fa fa-bolt"></i>*@
                        </div>
                        <small>Scheduled Today</small>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>Maintenance - Last 30 Days</h5>
                    </div>
                    <div class="ibox-content">
                        <div id="maitenance-open" style="height: 200px;"></div>
                    </div>
                </div>
            </div>

            <div class="col-lg-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>Maintenance Completed By User</h5>
                    </div>
                    <div class="ibox-content">
                        <div id="mcbu" style="height: 200px;"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">

            <div class="col-md-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>Incident Reports - Last 30 Days</h5>

                    </div>
                    <div class="ibox-content">
                        <div id="incident-open" style="height: 200px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="ibox float-e-margins">
            <div class="ibox-title">
                <h5>Your daily feed</h5>
                <div class="ibox-tools">
                    @*<span class="label label-warning-light pull-right">10 Messages</span>*@
                </div>
            </div>
            <div class="ibox-content">

                <div>
                    <div class="feed-activity-list">
                        @foreach (var item in Model.FeedItems)
                        {
                            <div class="feed-element">
                                <a href="profile.html" class="pull-left">
                                    <img alt="image" class="img-circle" src="@item.User.ImageThumbnailUrl">
                                </a>
                                <div class="media-body ">
                                    <small class="pull-right">@item.CreatedOn.ToShortDateString()</small>
                                    <strong>@item.User.FirstName @item.User.LastName</strong> @item.Description <br>
                                    <small class="text-muted">@Html.Timeago(item.CreatedOn)</small>
                                    @if (!string.IsNullOrEmpty(item.Message))
                                    {
                                        <div class="well">
                                            @item.Message
                                        </div>
                                    }

                                </div>
                            </div>
                        }

                        @*<div class="feed-element">
                                <a href="profile.html" class="pull-left">
                                    <img alt="image" class="img-circle" src="img/profile.jpg">
                                </a>
                                <div class="media-body ">
                                    <small class="pull-right">5m ago</small>
                                    <strong>Monica Smith</strong> posted a new blog. <br>
                                    <small class="text-muted">Today 5:60 pm - 12.06.2014</small>

                                </div>
                            </div>

                            <div class="feed-element">
                                <a href="profile.html" class="pull-left">
                                    <img alt="image" class="img-circle" src="img/a2.jpg">
                                </a>
                                <div class="media-body ">
                                    <small class="pull-right">2h ago</small>
                                    <strong>Mark Johnson</strong> posted message on <strong>Monica Smith</strong> site. <br>
                                    <small class="text-muted">Today 2:10 pm - 12.06.2014</small>
                                </div>
                            </div>
                            <div class="feed-element">
                                <a href="profile.html" class="pull-left">
                                    <img alt="image" class="img-circle" src="img/a3.jpg">
                                </a>
                                <div class="media-body ">
                                    <small class="pull-right">2h ago</small>
                                    <strong>Janet Rosowski</strong> add 1 photo on <strong>Monica Smith</strong>. <br>
                                    <small class="text-muted">2 days ago at 8:30am</small>
                                </div>
                            </div>
                            <div class="feed-element">
                                <a href="profile.html" class="pull-left">
                                    <img alt="image" class="img-circle" src="img/a4.jpg">
                                </a>
                                <div class="media-body ">
                                    <small class="pull-right text-navy">5h ago</small>
                                    <strong>Chris Johnatan Overtunk</strong> started following <strong>Monica Smith</strong>. <br>
                                    <small class="text-muted">Yesterday 1:21 pm - 11.06.2014</small>
                                    <div class="actions">
                                        <a class="btn btn-xs btn-white"><i class="fa fa-thumbs-up"></i> Like </a>
                                        <a class="btn btn-xs btn-white"><i class="fa fa-heart"></i> Love</a>
                                    </div>
                                </div>
                            </div>
                            <div class="feed-element">
                                <a href="profile.html" class="pull-left">
                                    <img alt="image" class="img-circle" src="img/a5.jpg">
                                </a>
                                <div class="media-body ">
                                    <small class="pull-right">2h ago</small>
                                    <strong>Kim Smith</strong> posted message on <strong>Monica Smith</strong> site. <br>
                                    <small class="text-muted">Yesterday 5:20 pm - 12.06.2014</small>
                                    <div class="well">
                                        Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s.
                                        Over the years, sometimes by accident, sometimes on purpose (injected humour and the like).
                                    </div>
                                    <div class="pull-right">
                                        <a class="btn btn-xs btn-white"><i class="fa fa-thumbs-up"></i> Like </a>
                                    </div>
                                </div>
                            </div>
                            <div class="feed-element">
                                <a href="profile.html" class="pull-left">
                                    <img alt="image" class="img-circle" src="img/profile.jpg">
                                </a>
                                <div class="media-body ">
                                    <small class="pull-right">23h ago</small>
                                    <strong>Monica Smith</strong> love <strong>Kim Smith</strong>. <br>
                                    <small class="text-muted">2 days ago at 2:30 am - 11.06.2014</small>
                                </div>
                            </div>
                            <div class="feed-element">
                                <a href="profile.html" class="pull-left">
                                    <img alt="image" class="img-circle" src="img/a7.jpg">
                                </a>
                                <div class="media-body ">
                                    <small class="pull-right">46h ago</small>
                                    <strong>Mike Loreipsum</strong> started following <strong>Monica Smith</strong>. <br>
                                    <small class="text-muted">3 days ago at 7:58 pm - 10.06.2014</small>
                                </div>
                            </div>*@
                    </div>

                    @*<button class="btn btn-primary btn-block m-t"><i class="fa fa-arrow-down"></i> Show More</button>*@

                </div>

            </div>
        </div>
    </div>

    <div class="clear-fix"></div>
</div>


@section scripts {
    <script>
        var options = {
            series: {
                pie: {
                    innerRadius: 0.3,
                    show: true,
                    label: {
                        show: true,
                        //radius: 1/2,
                        formatter: labelFormatter,
                        background: {

                            color: '#000'
                        }
                    }
                }
            },
            legend: {
                show: false
            },
            grid: {
                hoverable: true,
                clickable: true
            }
        };
        var mtdata = [
            { label: "Complete", data: @(Model.NumberCompleted) },
            { label: "Outstanding", data: @(Model.NumberOutstanding) },
            { label: "New", data: @(Model.NumberEntered) }
        ];
        var irdata = [
          { label: "Complete", data: @(Model.IncidentReportsComplete) },
          { label: "Outstanding", data: @(Model.IncidentReportsOutstanding) },
          { label: "New", data: @(Model.IncidentReportsNew) }
        ];
        var mcbu = @(Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(Model.WorkOrdersPerEmployee)));

        $(function () {
            $.plot('#maitenance-open', mtdata, options);
            $.plot('#incident-open', irdata, options);
            $.plot('#mcbu', mcbu, options);
        });
        function labelFormatter(label, series) {
            console.log(series);
            return "<div style='font-size:8pt; text-align:center; padding:2px; color: black;'>" + label + "<br/>" + Math.round(series.data[0][1]) + "</div>";
        }

    </script>
}
